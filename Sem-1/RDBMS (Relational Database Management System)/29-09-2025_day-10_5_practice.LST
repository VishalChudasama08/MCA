-- 5. Write a PLSQL block to display Supplier_Id and their total number of products they supply
SQL> select * from PRODUCTS;

   PROD_ID PROD_NAME            SUPPLIER_ID     CAT_ID UNIT            PRICE    
---------- -------------------- ----------- ---------- ---------- ----------    
         3 Product 3                    103          3 Pack               30    
         1 Product 1                    101          1 Piece             100    
         2 Product 2                    102          2 Box                30    
         4 Product 4                    104          1 Bag                15    

SQL> select * from ORDER_DETAILS;

ORDERDETAIL_ID   ORDER_ID    PROD_ID   QUANTITY                                 
-------------- ---------- ---------- ----------                                 
             1          3          1         10                                 
             2          3          2          5                                 
             3          3          3          3                                 

SQL> begin
  2  /
begin
    *
ERROR at line 1:
ORA-06550: line 1, column 5: 
PLS-00103: Encountered the symbol "end-of-file" when expecting one of the 
following: 
begin case declare exit for goto if loop mod null pragma 
raise return select update while with <an identifier> 
<a double-quoted delimited-identifier> <a bind variable> << 
close current delete fetch lock insert open rollback 
savepoint set sql execute commit forall merge pipe 


SQL> ed
Wrote file afiedt.buf

  1  declare
  2  	s_id number;
  3  	total_product number;
  4  	i number;
  5  begin
  6  	select count(Supplier_ID) INTO i from PRODUCTS;
  7  	while i>0;
  8  	loop
  9  		select Supplier_ID into s_id, Prod_ID into total_product from PRODUCTS where Supplier_ID=i; 
 10  		dbms_output.put_line(s_id || " " || total_product);
 11  		i:=i-1;
 12  	end loop;
 13* end;
SQL> /
	while i>0;
	         *
ERROR at line 7:
ORA-06550: line 7, column 11: 
PLS-00103: Encountered the symbol ";" when expecting one of the following: 
* & - + / at loop mod remainder rem <an exponent (**)> and or 
|| multiset 
ORA-06550: line 9, column 41: 
PLS-00103: Encountered the symbol "INTO" when expecting one of the following: 
. ( , % from 
The symbol ". was inserted before "INTO" to continue. 


SQL> ed
Wrote file afiedt.buf

  1  declare
  2  	s_id number;
  3  	total_product number;
  4  	i number;
  5  begin
  6  	select count(Supplier_ID) INTO i from PRODUCTS;
  7  dbms_output.put_line(i);
  8* end;
SQL> /

PL/SQL procedure successfully completed.

SQL> set serveroutput on;
SQL> /
4                                                                               

PL/SQL procedure successfully completed.

SQL> ed
Wrote file afiedt.buf

  1  declare
  2  	s_id number;
  3  	total_product number;
  4  	i number;
  5  begin
  6  	select count(Supplier_ID) INTO i from PRODUCTS;
  7  	dbms_output.put_line(i);
  8  	while i>0 
  9  	loop
 10  		select Supplier_ID into s_id, Prod_ID into total_product from PRODUCTS where Supplier_ID=i; 
 11  		dbms_output.put_line(s_id || " " || total_product);
 12  		i:=i-1;
 13  	end loop;
 14* end;
SQL> /
		select Supplier_ID into s_id, Prod_ID into total_product from PRODUCTS where Supplier_ID=i; 
		                                      *
ERROR at line 10:
ORA-06550: line 10, column 41: 
PL/SQL: ORA-00923: FROM keyword not found where expected 
ORA-06550: line 10, column 3: 
PL/SQL: SQL Statement ignored 


SQL> ed
Wrote file afiedt.buf

  1  declare
  2  	s_id number;
  3  	total_product number;
  4  	i number;
  5  begin
  6  	select count(Supplier_ID) INTO i from PRODUCTS;
  7  	dbms_output.put_line(i);
  8  	while i>0 
  9  	loop
 10  		select Prod_ID into total_product from PRODUCTS where Supplier_ID=i; 
 11  		dbms_output.put_line(total_product);
 12  		i:=i-1;
 13  	end loop;
 14* end;
SQL> /
4                                                                               
declare
*
ERROR at line 1:
ORA-01403: no data found 
ORA-06512: at line 10 


SQL> select Prod_ID from PRODUCTS where Supplier_ID=1;

no rows selected

SQL> ed
Wrote file afiedt.buf

  1* select Prod_ID from PRODUCTS where Supplier_ID=1
SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     dbms_output.put_line(i);
  8     while i>0
  9     loop
 10             select Prod_ID into total_product from PRODUCTS where Prod_ID=i;
 11             dbms_output.put_line(total_product);
 12             i:=i-1;
 13     end loop;
 14* end;
SQL> /
4                                                                               
4                                                                               
3                                                                               
2                                                                               
1                                                                               

PL/SQL procedure successfully completed.

SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     while i>0
  8     loop
  9             select Supplier_ID into s_id, Prod_ID into total_product from PRODUCTS where Prod_ID=i;
 10             dbms_output.put_line(s_id || " " || total_product);
 11             i:=i-1;
 12     end loop;
 13* end;
SQL> /
           select Supplier_ID into s_id, Prod_ID into total_product from PRODUCTS where Prod_ID=i;
                                                 *
ERROR at line 9:
ORA-06550: line 9, column 50: 
PL/SQL: ORA-00923: FROM keyword not found where expected 
ORA-06550: line 9, column 12: 
PL/SQL: SQL Statement ignored 


SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     while i>0
  8     loop
  9             select cout(Prod_ID) into total_product from PRODUCTS where Prod_ID=i;
 10             dbms_output.put_line(total_product);
 11             i:=i-1;
 12     end loop;
 13* end;
SQL> /
           select cout(Prod_ID) into total_product from PRODUCTS where Prod_ID=i;
                  *
ERROR at line 9:
ORA-06550: line 9, column 19: 
PL/SQL: ORA-00904: "COUT": invalid identifier 
ORA-06550: line 9, column 12: 
PL/SQL: SQL Statement ignored 


SQL> select cout(Prod_ID) from PRODUCTS group by Supplier_ID;
select cout(Prod_ID) from PRODUCTS group by Supplier_ID
       *
ERROR at line 1:
ORA-00904: "COUT": invalid identifier 


SQL> select count(Prod_ID) from PRODUCTS group by Supplier_ID;

COUNT(PROD_ID)                                                                  
--------------                                                                  
             1                                                                  
             1                                                                  
             1                                                                  
             1                                                                  

SQL> select count(Prod_ID) from PRODUCTS group by Supplier_ID having Prod_ID=1;
select count(Prod_ID) from PRODUCTS group by Supplier_ID having Prod_ID=1
                                                                *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ed
Wrote file afiedt.buf

  1* select count(Prod_ID) from PRODUCTS group by Prod_ID having Prod_ID=1
SQL> /

COUNT(PROD_ID)                                                                  
--------------                                                                  
             1                                                                  

SQL> ed
Wrote file afiedt.buf

  1* select count(Supplier_ID) from PRODUCTS group by Prod_ID having Prod_ID=1
SQL> /

COUNT(SUPPLIER_ID)                                                              
------------------                                                              
                 1                                                              

SQL> select * from PRODUCTS;

   PROD_ID PROD_NAME            SUPPLIER_ID     CAT_ID UNIT            PRICE    
---------- -------------------- ----------- ---------- ---------- ----------    
         3 Product 3                    103          3 Pack               30    
         1 Product 1                    101          1 Piece             100    
         2 Product 2                    102          2 Box                30    
         4 Product 4                    104          1 Bag                15    

SQL> INSERT INTO PRODUCTS (Prod_ID, Prod_Name, Supplier_ID, Cat_ID, Unit, Price) VALUES (4, 'Product 1', 101, 1, 'Piece', 10);
INSERT INTO PRODUCTS (Prod_ID, Prod_Name, Supplier_ID, Cat_ID, Unit, Price) VALUES (4, 'Product 1', 101, 1, 'Piece', 10)
*
ERROR at line 1:
ORA-00001: unique constraint (MCAB250013.SYS_C0048687) violated 


SQL> ed
Wrote file afiedt.buf

  1* INSERT INTO PRODUCTS (Prod_ID, Prod_Name, Supplier_ID, Cat_ID, Unit, Price) VALUES (5, 'Product 1', 101, 1, 'Piece', 10)
SQL> /

1 row created.

SQL> select * from products;

   PROD_ID PROD_NAME            SUPPLIER_ID     CAT_ID UNIT            PRICE    
---------- -------------------- ----------- ---------- ---------- ----------    
         5 Product 1                    101          1 Piece              10    
         3 Product 3                    103          3 Pack               30    
         1 Product 1                    101          1 Piece             100    
         2 Product 2                    102          2 Box                30    
         4 Product 4                    104          1 Bag                15    

SQL> select count(Supplier_ID) from PRODUCTS group by Prod_ID having Supplier_ID=101;
select count(Supplier_ID) from PRODUCTS group by Prod_ID having Supplier_ID=101
                                                                *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ed
Wrote file afiedt.buf

  1* select count(Supplier_ID) from PRODUCTS group by Supplier_ID having Supplier_ID=101
SQL> /

COUNT(SUPPLIER_ID)                                                              
------------------                                                              
                 2                                                              

SQL> set linesize 200;
SQL> set pagesize 100;
SQL> select * from emp;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7369 SMITH      CLERK           7902 17-DEC-80        800                    20                                                                                                                   
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30                                                                                                                   
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30                                                                                                                   
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20                                                                                                                   
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30                                                                                                                   
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30                                                                                                                   
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10                                                                                                                   
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20                                                                                                                   
      7839 KING       PRESIDENT            17-NOV-81       5000                    10                                                                                                                   
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0         30                                                                                                                   
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20                                                                                                                   
      7900 JAMES      CLERK           7698 03-DEC-81        950                    30                                                                                                                   
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20                                                                                                                   
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10                                                                                                                   

14 rows selected.

SQL> select * from emp where deptno not in (30);

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7369 SMITH      CLERK           7902 17-DEC-80        800                    20                                                                                                                   
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20                                                                                                                   
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10                                                                                                                   
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20                                                                                                                   
      7839 KING       PRESIDENT            17-NOV-81       5000                    10                                                                                                                   
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20                                                                                                                   
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20                                                                                                                   
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10                                                                                                                   

8 rows selected.

SQL> ed
Wrote file afiedt.buf

  1* select * from emp where deptno not in (30,20)
SQL> /

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10                                                                                                                   
      7839 KING       PRESIDENT            17-NOV-81       5000                    10                                                                                                                   
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10                                                                                                                   

SQL> ed
Wrote file afiedt.buf

  1* select * from emp where deptno not in 30
SQL> /

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7369 SMITH      CLERK           7902 17-DEC-80        800                    20                                                                                                                   
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20                                                                                                                   
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10                                                                                                                   
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20                                                                                                                   
      7839 KING       PRESIDENT            17-NOV-81       5000                    10                                                                                                                   
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20                                                                                                                   
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20                                                                                                                   
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10                                                                                                                   

8 rows selected.

SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     while i>0
  8     loop
  9  	   select count(Supplier_ID) into s_id from PRODUCTS group by Supplier_ID having Supplier_ID=101
 10             dbms_output.put_line(s_id);
 11             i:=i-1;
 12     end loop;
 13* end;
SQL> /
           dbms_output.put_line(s_id);
           *
ERROR at line 10:
ORA-06550: line 10, column 12: 
PL/SQL: ORA-00933: SQL command not properly ended 
ORA-06550: line 9, column 5: 
PL/SQL: SQL Statement ignored 


SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     while i>0
  8     loop
  9             select count(Supplier_ID) into s_id from PRODUCTS group by Supplier_ID having Supplier_ID=101;
 10             dbms_output.put_line(s_id);
 11             i:=i-1;
 12     end loop;
 13* end;
SQL> /
2                                                                                                                                                                                                       
2                                                                                                                                                                                                       
2                                                                                                                                                                                                       
2                                                                                                                                                                                                       
2                                                                                                                                                                                                       

PL/SQL procedure successfully completed.

SQL> ed
Wrote file afiedt.buf

  1  declare
  2     s_id number;
  3     total_product number;
  4     i number;
  5  begin
  6     select count(Supplier_ID) INTO i from PRODUCTS;
  7     while i>0
  8     loop
  9             select count(Supplier_ID) into s_id from PRODUCTS group by Supplier_ID having Supplier_ID=101;
 10             dbms_output.put_line(s_id);
 11             i:=i-1;
 12     end loop;
 13* end;
SQL> spool off;
